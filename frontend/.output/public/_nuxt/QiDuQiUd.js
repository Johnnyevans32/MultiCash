import{_ as Oe}from"./CMp65wxY.js";import{a as Fe,f as xe,o as q,V as Q,w as Be,R as ve,t as we,b as _,u as _e}from"./CaIJJZHX.js";import{P as z,M as L}from"./DWg-mp3v.js";import{b as Le}from"./7zzJsOrv.js";import{e as F,r as f,h as te,g as S,p as Ve,i as De,F as k,j as $e,k as Ce,l as Ue,_ as Z,m as U,o as u,q as B,w as A,b as C,c as v,v as I,a as n,n as R,t as r,x as Re,y as le,z as Ee,A as Me,B as oe,D as ae,C as je,d as X,E as P,G as D,H as ke,s as Pe,I as se,J as Se,K as be}from"./CDC5foPa.js";import{t as Ne}from"./CXSCOM6V.js";import{u as Ye}from"./CEedSPwL.js";import{_ as qe,a as Ge}from"./Cgvh75IJ.js";import{_ as re}from"./CvmaWrLj.js";import{_ as Te}from"./Czrw1GKb.js";import{_ as He}from"./B8cuFe5d.js";import{g as We,f as M,a as he,c as Ae}from"./BIfFRkhF.js";import{u as ue}from"./gh49L7wh.js";import{_ as Ke}from"./BrOrGAHD.js";import{_ as ze}from"./DIp1uth1.js";import"./CybuPCj8.js";import"./CzaTtXRt.js";import"./Cu3int81.js";let Je=F({props:{onFocus:{type:Function,required:!0}},setup(e){let t=f(!0);return()=>t.value?te(xe,{as:"button",type:"button",features:Fe.Focusable,onFocus(g){g.preventDefault();let p,a=50;function i(){var s;if(a--<=0){p&&cancelAnimationFrame(p);return}if((s=e.onFocus)!=null&&s.call(e)){t.value=!1,cancelAnimationFrame(p);return}p=requestAnimationFrame(i)}p=requestAnimationFrame(i)}}):null}}),Ie=Symbol("TabsContext");function ee(e){let t=Ue(Ie,null);if(t===null){let g=new Error(`<${e} /> is missing a parent <TabGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(g,ee),g}return t}let Xe=F({name:"TabGroup",emits:{change:e=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(e,{slots:t,attrs:g,emit:p}){let a=f(null),i=f([]),s=f([]),m=S(()=>e.selectedIndex!==null),y=S(()=>m.value?e.selectedIndex:a.value),h={selectedIndex:a,orientation:S(()=>e.vertical?"vertical":"horizontal"),activation:S(()=>e.manual?"manual":"auto"),tabs:i,panels:s,setSelectedIndex(l){y.value!==l&&p("change",l),m.value||(a.value=l)},registerTab(l){i.value.includes(l)||i.value.push(l)},unregisterTab(l){let o=i.value.indexOf(l);o!==-1&&i.value.splice(o,1)},registerPanel(l){s.value.includes(l)||s.value.push(l)},unregisterPanel(l){let o=s.value.indexOf(l);o!==-1&&s.value.splice(o,1)}};return Ve(Ie,h),De(()=>{var l;if(h.tabs.value.length<=0||e.selectedIndex===null&&a.value!==null)return;let o=h.tabs.value.map(d=>q(d)).filter(Boolean),x=o.filter(d=>!d.hasAttribute("disabled")),$=(l=e.selectedIndex)!=null?l:e.defaultIndex;if($<0)a.value=o.indexOf(x[0]);else if($>h.tabs.value.length)a.value=o.indexOf(x[x.length-1]);else{let d=o.slice(0,$),c=[...o.slice($),...d].find(b=>x.includes(b));if(!c)return;a.value=o.indexOf(c)}}),()=>{let l={selectedIndex:a.value};return te(k,[i.value.length<=0&&te(Je,{onFocus:()=>{for(let o of i.value){let x=q(o);if((x==null?void 0:x.tabIndex)===0)return x.focus(),!0}return!1}}),Q({theirProps:{...g,...Be(e,["selectedIndex","defaultIndex","manual","vertical","onChange"])},ourProps:{},slot:l,slots:t,attrs:g,name:"TabGroup"})])}}}),Qe=F({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(e,{attrs:t,slots:g}){let p=ee("TabList");return()=>{let a={selectedIndex:p.selectedIndex.value},i={role:"tablist","aria-orientation":p.orientation.value};return Q({ourProps:i,theirProps:e,slot:a,attrs:t,slots:g,name:"TabList"})}}}),Ze=F({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1}},setup(e,{attrs:t,slots:g,expose:p}){let a=ee("Tab"),i=`headlessui-tabs-tab-${we()}`,s=f(null);p({el:s,$el:s}),$e(()=>a.registerTab(s)),Ce(()=>a.unregisterTab(s));let m=S(()=>a.tabs.value.indexOf(s)),y=S(()=>m.value===a.selectedIndex.value);function h(c){let b=a.tabs.value.map(O=>q(O)).filter(Boolean);if(c.key===_.Space||c.key===_.Enter){c.preventDefault(),c.stopPropagation(),a.setSelectedIndex(m.value);return}switch(c.key){case _.Home:case _.PageUp:return c.preventDefault(),c.stopPropagation(),z(b,L.First);case _.End:case _.PageDown:return c.preventDefault(),c.stopPropagation(),z(b,L.Last)}if(_e(a.orientation.value,{vertical(){if(c.key===_.ArrowUp)return z(b,L.Previous|L.WrapAround);if(c.key===_.ArrowDown)return z(b,L.Next|L.WrapAround)},horizontal(){if(c.key===_.ArrowLeft)return z(b,L.Previous|L.WrapAround);if(c.key===_.ArrowRight)return z(b,L.Next|L.WrapAround)}}))return c.preventDefault()}function l(){var c;(c=q(s))==null||c.focus()}let o=f(!1);function x(){var c;o.value||(o.value=!0,!e.disabled&&((c=q(s))==null||c.focus(),a.setSelectedIndex(m.value),Ne(()=>{o.value=!1})))}function $(c){c.preventDefault()}let d=Le(S(()=>({as:e.as,type:t.type})),s);return()=>{var c;let b={selected:y.value},O={ref:s,onKeydown:h,onFocus:a.activation.value==="manual"?l:x,onMousedown:$,onClick:x,id:i,role:"tab",type:d.value,"aria-controls":(c=q(a.panels.value[m.value]))==null?void 0:c.id,"aria-selected":y.value,tabIndex:y.value?0:-1,disabled:e.disabled?!0:void 0};return Q({ourProps:O,theirProps:e,slot:b,attrs:t,slots:g,name:"Tab"})}}}),et=F({name:"TabPanels",props:{as:{type:[Object,String],default:"div"}},setup(e,{slots:t,attrs:g}){let p=ee("TabPanels");return()=>{let a={selectedIndex:p.selectedIndex.value};return Q({theirProps:e,ourProps:{},slot:a,attrs:g,slots:t,name:"TabPanels"})}}}),tt=F({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(e,{attrs:t,slots:g,expose:p}){let a=ee("TabPanel"),i=`headlessui-tabs-panel-${we()}`,s=f(null);p({el:s,$el:s}),$e(()=>a.registerPanel(s)),Ce(()=>a.unregisterPanel(s));let m=S(()=>a.panels.value.indexOf(s)),y=S(()=>m.value===a.selectedIndex.value);return()=>{var h;let l={selected:y.value},o={ref:s,id:i,role:"tabpanel","aria-labelledby":(h=q(a.tabs.value[m.value]))==null?void 0:h.id,tabIndex:y.value?0:-1};return!y.value&&e.unmount?te(xe,{as:"span",...o}):Q({ourProps:o,theirProps:e,slot:l,attrs:t,slots:g,features:ve.Static|ve.RenderStrategy,visible:y.value,name:"TabPanel"})}}});const nt=F({components:{TabGroup:Xe,TabList:Qe,Tab:Ze,TabPanels:et,TabPanel:tt},props:{tabs:{type:Array,default:()=>[]},modelValue:{type:Number,default:null}},setup(e,{emit:t}){const g=f(0),p=S({get:()=>e.modelValue!==null?e.modelValue:g.value,set:i=>{e.modelValue!==null?t("update:modelValue",i):g.value=i}});function a(i){p.value=i}return{activeTab:p,changeTab:a}}});function ot(e,t,g,p,a,i){const s=U("Tab"),m=U("TabList"),y=U("TabPanel"),h=U("TabPanels"),l=U("TabGroup");return u(),B(l,{selectedIndex:e.activeTab,onChange:e.changeTab},{default:A(()=>[C(m,{class:"flex rounded-xl w-full bg-lightbase p-2"},{default:A(()=>[(u(!0),v(k,null,I(e.tabs,o=>(u(),B(s,{key:o.title,as:"template"},{default:A(({selected:x})=>[n("div",{class:R(["w-full rounded-xl py-1 cursor-pointer ",x&&"bg-base shadow"])},r(o.title),3)]),_:2},1024))),128))]),_:1}),C(h,{class:"mt-4"},{default:A(()=>[(u(!0),v(k,null,I(e.tabs,o=>(u(),B(y,{key:o.title},{default:A(()=>[(u(),B(Re(o.content)))]),_:2},1024))),128))]),_:1})]),_:1},8,["selectedIndex","onChange"])}const at=Z(nt,[["render",ot]]),st={class:"flex justify-center gap-2"},lt=F({__name:"RatingInput",props:{modelValue:{},maxRating:{}},emits:["update:modelValue"],setup(e,{emit:t}){const g=e,p=t,a=f(g.modelValue||0),i=f(a.value),s=m=>{a.value=m,console.log({value:m}),p("update:modelValue",a.value)};return(m,y)=>{const h=U("font-awesome-icon");return u(),v("div",st,[(u(!0),v(k,null,I(m.maxRating,l=>(u(),B(h,{key:l,icon:i.value>=l?["fas","star"]:["far","star"],onClick:o=>s(l),onMouseover:o=>i.value=l,onMouseleave:y[0]||(y[0]=o=>i.value=a.value),class:"cursor-pointer text-3xl"},null,8,["icon","onClick","onMouseover"]))),128))])}}}),rt=F({setup(){var j,E;const{$api:e}=le(),{withLoadingPromise:t}=ue();Ee(()=>{h()});const g=Me();oe(()=>g.query.r,()=>{h()});const p=f(1),a=w=>{p.value=w,h()},i=f([]),s=f(),m=S(()=>We(i.value,"createdAt")),y=f(!1),h=async()=>{await t(e.exchangeService.fetchExchanges(p.value).then(({data:w,metadata:V})=>{s.value=V,i.value=w}),y)},l=f(!1),o=f(),x=w=>{o.value=w,l.value=!0},$=f(!1),d=f((j=o.value)==null?void 0:j.comment),c=f(((E=o.value)==null?void 0:E.rating)||0),b=f(!1),O=async()=>{var w;o.value&&await t(e.exchangeService.rateExchange((w=o.value)==null?void 0:w.id,c.value,d.value).then(()=>{h(),b.value=!1,ae({type:"success",title:"acknowledged"})}),$)},G=f({pending:"text-blue-700 bg-blue-100",processing:"text-yellow-700 bg-yellow-100",awaiting_order:"text-orange-700 bg-orange-100",order_placed:"text-purple-700 bg-purple-100",cancelled:"text-red-700 bg-red-100",completed:"text-green-700 bg-green-100"}),H=f({pending:"text-blue-700 bg-blue-100",processing:"text-yellow-700 bg-yellow-100",completed:"text-green-700 bg-green-100",failed:"text-red-700 bg-red-100",cancelled:"text-gray-700 bg-gray-100",partially_completed:"text-orange-700 bg-orange-100"});return{exchanges:i,exchangesMetadata:s,isLoadingExchanges:y,handlePageChange:a,formatedExchanges:m,updateExchangeModal:l,openExchangeModal:x,modalExchange:o,feedbackModal:b,comment:d,isLoadingGiveFeedbackOnExchange:$,giveFeedbackOnExchange:O,rating:c,offeringStatusStyles:G,exchangeStatusStyles:H}}}),ut={key:0},it={key:1},ct=["onClick"],dt={class:"flex md:space-x-2 space-x-1 items-center"},pt={class:"truncate md:text-sm text-xs"},mt={key:2},ft={class:"flex flex-col gap-2"},gt={class:"flex flex-col"},yt={class:"font-bold"},vt={class:"flex flex-col"},bt={class:"font-bold"},ht={class:"flex flex-col"},xt={class:"font-bold"},wt={class:"font-bold"},$t={class:"flex flex-col"},Ct={class:"font-bold"},Et={class:"flex flex-col items-start"},Mt={class:"flex flex-col"},kt={class:"font-bold"},Pt={key:0,class:"flex flex-col"},St={class:"font-bold"},Tt={key:1,class:"flex flex-col gap-2 font-bold"},At={key:0,class:"absolute bottom-0 left-[calc(0.25rem-0.5px)] top-0 w-px bg-base group-first:top-3"},It={class:"flex flex-col"},Ot={class:"flex justify-between"},Ft={class:"flex flex-col gap-4"};function Bt(e,t,g,p,a,i){var x,$;const s=U("font-awesome-icon"),m=qe,y=re,h=Te,l=lt,o=He;return u(),v(k,null,[e.isLoadingExchanges?(u(),v("div",ut,[(u(),v(k,null,I(2,d=>n("div",{key:d},[t[8]||(t[8]=n("div",{class:"h-2 w-20 bg-base rounded mb-2"},null,-1)),(u(),v(k,null,I(2,c=>n("div",{key:c,class:"cursor-progress p-5 flex mb-2 items-center h-16 justify-between rounded-xl text-base bg-lightbase border-[1px] border-base animate-pulse"},t[7]||(t[7]=[je('<div class="flex space-x-2 items-center"><div class="bg-base h-10 w-10 rounded-xl"></div><div class="flex flex-col gap-2"><div class="h-2 w-32 bg-base rounded"></div></div></div><div class="flex flex-col gap-2"><div class="h-2 w-20 bg-base rounded"></div></div>',2)]))),64))])),64))])):!e.isLoadingExchanges&&e.exchanges.length?(u(),v("div",it,[(u(!0),v(k,null,I(e.formatedExchanges,(d,c)=>(u(),v("div",{key:c,class:"text-left"},[n("span",null,r(c),1),(u(!0),v(k,null,I(d,b=>(u(),v("div",{key:b.id,class:"cursor-pointer py-5 md:px-5 px-2 flex mb-2 items-center h-16 justify-between rounded-xl text-base bg-lightbase border-[1px] border-base",onClick:O=>e.openExchangeModal(b)},[n("div",dt,[C(s,{icon:"exchange"}),n("span",pt,[X(r(b.payinCurrency)+" "+r(("formatMoney"in e?e.formatMoney:P(M))(b.payinAmount))+" ",1),C(s,{icon:"fas fa-arrow-right ",class:"mx-1"}),X(" "+r(b.payoutCurrency)+" "+r(("formatMoney"in e?e.formatMoney:P(M))(b.payoutAmount)),1)])]),n("span",{class:R(["md:text-xs text-tiny py-1 px-2 rounded-lg",e.exchangeStatusStyles[b.status]])},r(b==null?void 0:b.status),3)],8,ct))),128))]))),128))])):(u(),v("div",mt,[C(s,{class:"text-7xl mb-5",icon:"money-bill-transfer"}),t[9]||(t[9]=n("p",null,"Nothing to see here",-1)),t[10]||(t[10]=n("p",null,"your currency exchanges will appear here once they arrive.",-1))])),e.exchanges.length?(u(),B(m,{key:3,currentPage:(x=e.exchangesMetadata)==null?void 0:x.page,totalItems:($=e.exchangesMetadata)==null?void 0:$.totalDocs,onChangeOption:e.handlePageChange},null,8,["currentPage","totalItems","onChangeOption"])):D("",!0),e.modalExchange?(u(),B(h,{key:4,open:e.updateExchangeModal,title:"Exchange Details",onChangeModalStatus:t[2]||(t[2]=d=>{e.updateExchangeModal=d})},{content:A(()=>{var d,c,b,O,G,H,j,E,w,V,W,K,N,Y;return[n("div",ft,[n("div",gt,[n("span",null,"You "+r(((d=e.modalExchange)==null?void 0:d.status)==="completed"?"exchanged":"are exchanging")+":",1),n("span",yt,r((c=e.modalExchange)==null?void 0:c.payinCurrency)+" "+r(("formatMoney"in e?e.formatMoney:P(M))(((b=e.modalExchange)==null?void 0:b.payinAmount)||0)),1)]),n("div",vt,[t[11]||(t[11]=n("span",null,"For:",-1)),n("span",bt,r((O=e.modalExchange)==null?void 0:O.payoutCurrency)+" "+r(("formatMoney"in e?e.formatMoney:P(M))(((G=e.modalExchange)==null?void 0:G.payoutAmount)||0)),1)]),n("div",ht,[t[12]||(t[12]=n("span",null,"Exchange Rate:",-1)),n("span",xt," 1 "+r((H=e.modalExchange)==null?void 0:H.payinCurrency)+" = "+r(("formatMoney"in e?e.formatMoney:P(M))((j=e.modalExchange)==null?void 0:j.payoutUnitsPerPayinUnit,5))+" "+r((E=e.modalExchange)==null?void 0:E.payoutCurrency),1),n("span",wt," 1 "+r(e.modalExchange.payoutCurrency)+" = "+r(("formatMoney"in e?e.formatMoney:P(M))(1/e.modalExchange.payoutUnitsPerPayinUnit,5))+" "+r(e.modalExchange.payinCurrency),1)]),n("div",$t,[t[13]||(t[13]=n("span",null,"Fee:",-1)),n("span",Ct,r((w=e.modalExchange)==null?void 0:w.payinCurrency)+" "+r(("formatMoney"in e?e.formatMoney:P(M))(((V=e.modalExchange)==null?void 0:V.totalFee)||0)),1)]),n("div",Et,[t[14]||(t[14]=n("span",null,"Status:",-1)),n("span",{class:R(["font-bold md:text-xs text-tiny py-1 px-2 rounded-lg",e.exchangeStatusStyles[e.modalExchange.status]])},r((W=e.modalExchange)==null?void 0:W.status),3)]),n("div",Mt,[t[15]||(t[15]=n("span",null,"Date:",-1)),n("span",kt,r(((K=e.modalExchange)==null?void 0:K.createdAt)&&("formatDate"in e?e.formatDate:P(he))(e.modalExchange.createdAt,"ddd, MMM Do YYYY, h:mm:ss a")),1)]),e.modalExchange.completionDate?(u(),v("div",Pt,[t[16]||(t[16]=n("span",null,"Completion Date:",-1)),n("span",St,r(("formatDate"in e?e.formatDate:P(he))(e.modalExchange.completionDate,"ddd, MMM Do YYYY, h:mm:ss a")),1)])):D("",!0),(Y=(N=e.modalExchange)==null?void 0:N.offerings)!=null&&Y.length?(u(),v("div",Tt,[t[17]||(t[17]=n("span",null,"Exchange Route:",-1)),n("ol",null,[(u(!0),v(k,null,I(e.modalExchange.offerings,(T,ne)=>{var J;return u(),v("li",{key:T.id,class:"group relative pb-5 pl-7 last:pb-0"},[ne!==e.modalExchange.offerings.length-1?(u(),v("div",At)):D("",!0),C(s,{icon:T.status==="completed"?"check-circle":"dot-circle",class:R([e.offeringStatusStyles[T.status],"bg-lightbase absolute -left-1 top-1 rounded-full"])},null,8,["icon","class"]),n("div",It,[n("div",Ot,[n("span",null,r((J=T.pfi)==null?void 0:J.name),1),n("span",{class:R([e.offeringStatusStyles[T.status],"md:text-xs text-tiny py-1 px-2 rounded-lg"])},r(T.status.replace("_"," ")),3)]),n("span",null," 1 "+r(T.payinCurrency)+" = "+r(("formatMoney"in e?e.formatMoney:P(M))(T.payoutUnitsPerPayinUnit,5))+" "+r(T.payoutCurrency),1),n("span",null," PFI fee: "+r(T.payinCurrency)+" "+r(("formatMoney"in e?e.formatMoney:P(M))(T.pfiFee||0)),1)])])}),128))])])):D("",!0)])]}),footer:A(()=>[C(y,{text:"Close",onBtnAction:t[0]||(t[0]=d=>e.updateExchangeModal=!1),"custom-css":"bg-base w-full text-base"}),!e.modalExchange.rating&&!e.modalExchange.comment&&e.modalExchange.status==="completed"?(u(),B(y,{key:0,text:"Give feedback",onBtnAction:t[1]||(t[1]=()=>{e.updateExchangeModal=!1,e.feedbackModal=!0}),"custom-css":"!bg-blue-600 w-full text-white"})):D("",!0)]),_:1},8,["open"])):D("",!0),C(h,{open:e.feedbackModal,title:"Give feedback on exchange",onChangeModalStatus:t[6]||(t[6]=d=>{e.feedbackModal=d})},{content:A(()=>[n("div",Ft,[C(l,{modelValue:e.rating,"onUpdate:modelValue":t[3]||(t[3]=d=>e.rating=d),maxRating:5},null,8,["modelValue"]),C(o,{modelValue:e.comment,"onUpdate:modelValue":t[4]||(t[4]=d=>e.comment=d),placeholder:"Your feedback helps us improve. Type here...",title:"Add comment",onKeyup:ke(e.giveFeedbackOnExchange,["enter"])},null,8,["modelValue","onKeyup"])])]),footer:A(()=>[C(y,{text:"Cancel",onBtnAction:t[5]||(t[5]=d=>e.feedbackModal=!1),"custom-css":"bg-red-600 w-full text-white"}),C(y,{text:"Send",onBtnAction:e.giveFeedbackOnExchange,"custom-css":"!bg-blue-600 w-full text-white",loading:e.isLoadingGiveFeedbackOnExchange},null,8,["onBtnAction","loading"])]),_:1},8,["open"])],64)}const _t=Z(rt,[["render",Bt]]),Lt=F({props:{matchedOfferings:{type:Array,required:!0}},setup(e){const t=f(),g=f(!1),{$api:p}=le(),a=f(),{wallets:i}=Pe(se()),s=E=>{t.value=E,g.value=!0},m=S(()=>i.value.find(E=>{var w;return E.currency===((w=t.value)==null?void 0:w.payinCurrency)})),{withLoadingPromise:y}=ue(),h=f(!1),l=Se(),o=f(!1),x=async()=>{var E;if(!a.value){ae({type:"error",title:"invalid pay in amount inputted."});return}t.value&&a.value&&await y(p.exchangeService.createExchange({payinAmount:a.value,offerings:(E=t.value)==null?void 0:E.offerings.map(w=>w.pfiOfferingId)}).then(()=>{g.value=!1,o.value=!0}),h)},$=f(!1),d=f(),c=async()=>{var E;if(!a.value){ae({type:"error",title:"invalid pay in amount inputted."}),d.value=null;return}t.value&&a.value&&await y(p.exchangeService.fetchExchangeSummary({payinAmount:a.value,offerings:(E=t.value)==null?void 0:E.offerings.map(w=>w.pfiOfferingId)}).then(w=>{d.value=w}).catch(()=>{d.value=null}),$)},b=f("Highest payout"),O=f(e.matchedOfferings),G=S(()=>{const E={"Highest payout":{key:"cumulativePayoutUnitsPerPayinUnit",order:"desc"},"Fastest settlement time":{key:"cumulativeSettlementTimeInSecs",order:"asc"},"Cheapest fee":{key:"cumulativeFee",order:"asc"}},{key:w,order:V}=E[b.value]||{};return w?O.value.sort((W,K)=>{const N=W[w]??0,Y=K[w]??0;return V==="asc"?N-Y:Y-N}):O.value}),H=()=>{l.push({query:{tab:"history"}}),o.value=!1},j=S(()=>{var J,ie,ce,de,pe,me,fe,ge,ye;const E=((J=t.value)==null?void 0:J.payinCurrency)||"N/A",w=((ie=t.value)==null?void 0:ie.payoutCurrency)||"N/A",V=((ce=t.value)==null?void 0:ce.cumulativePayoutUnitsPerPayinUnit)||0,W=((de=t.value)==null?void 0:de.cumulativeFee)||0,K=((pe=d.value)==null?void 0:pe.platformFee)||0,N=((me=d.value)==null?void 0:me.totalFee)||0,Y=((fe=d.value)==null?void 0:fe.totalPayinAmount)||0,T=((ge=d.value)==null?void 0:ge.payoutAmount)||0,ne=((ye=t.value)==null?void 0:ye.cumulativeSettlementTimeInSecs)||0;return[{title:"Exchange rate",values:[`1 ${E} = ${M(V,4)} ${w}`,`1 ${w} = ${M(1/V,4)} ${E}`]},{title:"Platform fee",values:[`${M(K)} ${E}`]},{title:"PFI(s) fee",values:[`${M(W)} ${E}`]},{title:"Total fee",values:[`${M(N)} ${E}`]},{title:"You will be debited",values:[`${M(Y)} ${E}`]},{title:"You will receive",values:[`${M(T)} ${w}`]},{title:"Estimated settlement time",values:[`${Ae(ne,"seconds","hours")} Hours`]}]});return{selectedOffering:t,exchangeModal:g,payinAmount:a,isLoadingCreateExchange:h,selectOffering:s,createExchange:x,wallet:m,goToHistory:H,showSuccessModal:o,sortMethod:b,sortedMatchedOfferings:G,exchangeSummary:d,fetchExchangeSummary:c,summaries:j,isLoadingFetchExchangeSummary:$}}}),Vt={class:"flex flex-col gap-2 text-left"},Dt={class:"flex items-center justify-between"},Ut=["onClick"],Rt={class:"flex items-center justify-between"},jt={class:"block font-bold"},Nt={class:"text-right"},Yt={class:"block font-bold"},qt={class:"flex items-center justify-between"},Gt={class:"block text-green-600 font-bold"},Ht={class:"flex flex-col gap-4 text-base"},Wt={class:"flex flex-col gap-2"},Kt={key:0,class:"absolute bottom-0 left-[calc(0.25rem-0.5px)] top-0 w-px bg-base group-first:top-3"},zt={class:"flex flex-col items-start"},Jt={class:"font-bold"},Xt={class:"text-sm"},Qt={class:"flex flex-col"},Zt={class:"flex flex-col text-sm"},en={class:"flex flex-col text-right font-bold"},tn={class:"flex flex-col gap-4 items-center"};function nn(e,t,g,p,a,i){const s=Ge,m=re,y=U("font-awesome-icon"),h=ze,l=Te;return u(),v(k,null,[n("div",Vt,[n("div",Dt,[t[6]||(t[6]=n("span",{class:"md:text-sm text-xs"},"Select your prefered offering:",-1)),C(s,{selected:e.sortMethod,options:["Cheapest fee","Highest payout","Fastest settlement time"],onChangeOption:t[0]||(t[0]=o=>{e.sortMethod=o}),customCss:"w-full md:text-sm text-xs"},null,8,["selected"])]),(u(!0),v(k,null,I(e.sortedMatchedOfferings,(o,x)=>(u(),v("div",{key:x,class:"cursor-pointer py-4 px-5 flex flex-col gap-4 rounded-xl bg-lightbase border-[1px] border-base md:text-sm text-xs",onClick:$=>e.selectOffering(o)},[n("div",Rt,[n("div",null,[t[7]||(t[7]=n("span",null,"PFI(s) Fee:",-1)),n("span",jt,r(o.payinCurrency)+" "+r(("formatMoney"in e?e.formatMoney:P(M))(o.cumulativeFee)),1)]),n("span",{class:R([{"bg-blue-100 text-blue-700":o.offerings.length>1,"bg-green-100 text-green-700":o.offerings.length===1},"md:text-xs text-tiny py-1 px-2 rounded-xl"])},r(o.offerings.length>1?"chained":"single")+" offering ",3),n("div",Nt,[t[8]||(t[8]=n("span",null,"Settlement Time:",-1)),n("span",Yt,r(("convertTime"in e?e.convertTime:P(Ae))(o.cumulativeSettlementTimeInSecs,"seconds","hours"))+" hours ",1)])]),n("div",qt,[n("div",null,[t[9]||(t[9]=n("span",null,"Exchange Rate:",-1)),n("span",Gt," 1 "+r(o.payinCurrency)+" = "+r(("formatMoney"in e?e.formatMoney:P(M))(o.cumulativePayoutUnitsPerPayinUnit,8))+" "+r(o.payoutCurrency),1)]),C(m,{text:"Select Offering",onBtnAction:$=>e.selectOffering(o),"custom-css":"!bg-blue-600 text-white"},null,8,["onBtnAction"])])],8,Ut))),128))]),e.selectedOffering?(u(),B(l,{key:0,open:e.exchangeModal,title:"Exchange Summary",onChangeModalStatus:t[3]||(t[3]=o=>{e.exchangeModal=o})},{content:A(()=>{var o,x;return[n("div",Ht,[n("div",Wt,[t[10]||(t[10]=n("span",{class:"font-bold"},"Selected Exchange Route:",-1)),n("ol",null,[(u(!0),v(k,null,I(e.selectedOffering.offerings,($,d)=>(u(),v("li",{key:d,class:"group relative pb-3 pl-7 last:pb-0"},[d!==e.selectedOffering.offerings.length-1?(u(),v("div",Kt)):D("",!0),C(y,{icon:"dot-circle",class:"bg-lightbase absolute -left-1 top-1 rounded-full"}),n("div",zt,[n("span",Jt,r($.pfiName),1),n("span",Xt,r($.payinCurrency)+" â†’ "+r($.payoutCurrency),1)])]))),128))])]),n("div",Qt,[C(h,{modelValue:e.payinAmount,"onUpdate:modelValue":t[1]||(t[1]=$=>e.payinAmount=$),title:"Enter amount",currency:e.selectedOffering.payinCurrency,balance:(o=e.wallet)==null?void 0:o.availableBalance,max:(x=e.wallet)==null?void 0:x.availableBalance,min:0,onKeyup:ke(e.createExchange,["enter"]),onInput:e.fetchExchangeSummary},null,8,["modelValue","currency","balance","max","onKeyup","onInput"])]),n("div",Zt,[t[11]||(t[11]=n("span",{class:"border-b-[1px] border-base"},"Summary:",-1)),(u(!0),v(k,null,I(e.summaries,($,d)=>(u(),v("div",{key:d,class:R(["flex justify-between items-center border-b-[1px] border-base",{"border-b-[0px]":d===e.summaries.length-1}])},[n("span",null,r($.title)+":",1),n("div",en,[e.isLoadingFetchExchangeSummary?(u(),v("div",{key:0,class:R(["h-2 w-24 bg-base rounded animate-pulse",$.values.length>1&&"h-6 my-2"])},null,2)):(u(!0),v(k,{key:1},I($.values,(c,b)=>(u(),v("span",{key:b},r(c),1))),128))])],2))),128))])])]}),footer:A(()=>[C(m,{text:"Cancel",onBtnAction:t[2]||(t[2]=o=>e.exchangeModal=!1),"custom-css":"bg-red-600 w-full text-white"}),C(m,{text:"Proceed",onBtnAction:e.createExchange,"custom-css":"!bg-green-600 w-full text-white",loading:e.isLoadingCreateExchange},null,8,["onBtnAction","loading"])]),_:1},8,["open"])):D("",!0),e.selectedOffering?(u(),B(l,{key:1,open:e.showSuccessModal,title:"Exchange Initiation Successful",onChangeModalStatus:t[5]||(t[5]=o=>{e.showSuccessModal=o})},{content:A(()=>{var o;return[n("div",tn,[C(y,{icon:"check-circle",class:"text-7xl text-green-600"}),t[14]||(t[14]=n("div",{class:"text-xl font-bold"}," ðŸŽ‰ Your exchange was successfully initiated! ",-1)),n("div",null,[X(" You have successfully created an exchange of "+r()+" ",1),n("strong",null,r(("formatMoney"in e?e.formatMoney:P(M))(e.payinAmount))+" "+r(e.selectedOffering.payinCurrency),1),t[12]||(t[12]=X(" to ")),n("strong",null,r(("formatMoney"in e?e.formatMoney:P(M))((o=e.exchangeSummary)==null?void 0:o.payoutAmount))+" "+r(e.selectedOffering.payoutCurrency),1),t[13]||(t[13]=X(". "))]),t[15]||(t[15]=n("div",{class:"text-sm text-left"}," Please note: Credits for exchanges typically settle into the payout currency within 1 to 3 minutes, which is the estimated time to process quotes and orders via tbDEX. Settlement may occur faster or take longer, depending on the number of exchange routes, as these are processed sequentially. ",-1))])]}),footer:A(()=>[C(m,{text:"Close",onBtnAction:t[4]||(t[4]=o=>e.showSuccessModal=!1),"custom-css":"bg-base w-full text-base"}),C(m,{text:"Go to History",onBtnAction:e.goToHistory,"custom-css":"!bg-green-600 w-full text-white"},null,8,["onBtnAction"])]),_:1},8,["open"])):D("",!0)],64)}const on=Z(Lt,[["render",nn]]),an=F({setup(){const{$api:e}=le(),{wallets:t}=Pe(se()),{setWallets:g}=se(),{withLoadingPromise:p}=ue();Ee(async()=>{await y()});const a=f(""),i=f(""),s=S(()=>t.value.map(x=>x.currency)),m=f(!1),y=async()=>{await p(e.walletService.fetchWallets().then(x=>{g(x)}),m)},h=f([]),l=f(!1);return{payinCurrency:a,payoutCurrency:i,exchangeCurrencies:s,isLoadingWallets:m,getOfferings:async()=>{await p(e.exchangeService.getOfferings(a.value,i.value).then(x=>{h.value=x}),l)},isLoadingOfferings:l,matchedOfferings:h}}}),sn={class:"flex flex-col gap-4"},ln={key:0},rn={key:2};function un(e,t,g,p,a,i){const s=Ke,m=re,y=on,h=U("font-awesome-icon");return u(),v("div",sn,[C(s,{title:"Choose Pay In Currency",selected:e.payinCurrency,options:e.exchangeCurrencies,onChangeOption:t[0]||(t[0]=l=>{e.payinCurrency=l}),placeholder:"-- Please choose the currency you want to convert from --"},null,8,["selected","options"]),C(s,{title:"Choose Pay Out Currency",selected:e.payoutCurrency,options:e.exchangeCurrencies,onChangeOption:t[1]||(t[1]=l=>{e.payoutCurrency=l}),placeholder:"-- Please choose the currency you want to convert to --"},null,8,["selected","options"]),C(m,{text:"Get Offerings",onBtnAction:e.getOfferings,loading:e.isLoadingOfferings,"custom-css":"!bg-blue-600 w-full text-white"},null,8,["onBtnAction","loading"]),e.isLoadingOfferings?(u(),v("div",ln,[t[2]||(t[2]=n("div",{class:"flex justify-between items-center"},[n("div",{class:"h-2 w-28 bg-base rounded mb-2"}),n("div",{class:"h-4 w-28 bg-base rounded mb-2"})],-1)),(u(),v(k,null,I(2,l=>n("div",{key:l,class:"cursor-progress p-5 flex mb-2 items-center h-24 justify-between rounded-xl text-base bg-lightbase border-[1px] border-base animate-pulse"})),64))])):!e.isLoadingOfferings&&e.matchedOfferings.length?(u(),B(y,{key:1,matchedOfferings:e.matchedOfferings},null,8,["matchedOfferings"])):(u(),v("div",rn,[C(h,{class:"text-7xl mb-5",icon:"box-open"}),t[3]||(t[3]=n("p",null,"No matched offerings found yet",-1))]))])}const cn=Z(an,[["render",un]]),dn=F({async setup(){Ye({title:"Exchange",ogTitle:"Exchange"});const e=f([{title:"Initiate Exchange",value:"initiate",content:be(cn)},{title:"Exchange History",value:"history",content:be(_t)}]),t=Me(),g=Se(),p=i=>{const s=e.value.findIndex(m=>m.value===i);return s!==-1?s:0},a=f(p(t.query.tab));return oe(()=>t.query.tab,i=>{a.value=p(i)}),oe(a,i=>{g.replace({query:{...t.query,tab:e.value[i].value}})}),{tabs:e,activeTab:a}}}),pn={class:"border-b-[1px] border-base text-left py-5"};function mn(e,t,g,p,a,i){const s=Oe,m=at;return u(),v(k,null,[n("div",pn,[C(s,{mainPage:"Exchange"})]),C(m,{tabs:e.tabs,modelValue:e.activeTab,"onUpdate:modelValue":t[0]||(t[0]=y=>e.activeTab=y)},null,8,["tabs","modelValue"])],64)}const On=Z(dn,[["render",mn]]);export{On as default};
